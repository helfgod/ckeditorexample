/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3f91=['register','targetRect','_sortAnnotations','change:isFocused','_updateAnnotationsTargetRect','annotations-register-already-registered','uiType','annotations-invalid-target','function','map','customView','from','_throttledOrderUpdate','destroy','locale','max','add','has','get','Annotations','focusTracker','_getOrderInContent','sort','set','element','getTarget','activeView','refresh','detach','left','pluginName','top','remove','_customViewToTarget','_customViewToAnnotationView','attach','delete','context','annotations-duplicated-item','getAnnotationView','_uis','items','resize','getIndex','init','cancel','render','_updateAnnotationTargetRect','isActive'];(function(_0x1cb143,_0x3f9182){const _0x514995=function(_0x58a22b){while(--_0x58a22b){_0x1cb143['push'](_0x1cb143['shift']());}};_0x514995(++_0x3f9182);}(_0x3f91,0xdc));const _0x5149=function(_0x1cb143,_0x3f9182){_0x1cb143=_0x1cb143-0x0;let _0x514995=_0x3f91[_0x1cb143];return _0x514995;};import _0x3313a9 from'@ckeditor/ckeditor5-core/src/contextplugin';import _0x462dc9 from'../annotations/view/annotationview';import _0x1b731a from'@ckeditor/ckeditor5-utils/src/collection';import _0x54a10b from'@ckeditor/ckeditor5-utils/src/focustracker';import _0x3316df from'@ckeditor/ckeditor5-utils/src/dom/rect';import _0x286f97 from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{throttle as _0x1a082f,isElement as _0x31097f}from'lodash-es';import'../../theme/annotation.css';export default class g extends _0x3313a9{static get[_0x5149('0x6')](){return _0x5149('0x2c');}constructor(_0x562d07){super(_0x562d07),this[_0x5149('0x11')]=new _0x1b731a(),this['set']('selectedViews',[]),this[_0x5149('0x30')](_0x5149('0x2'),null),this['on']('change:activeView',(_0x422da2,_0x36d25f,_0x1a86df,_0x56dcf7)=>{const _0x41c318=this[_0x5149('0xa')][_0x5149('0x2b')](_0x56dcf7);_0x56dcf7&&_0x41c318&&(_0x41c318[_0x5149('0x18')]=!0x1),_0x1a86df&&(this[_0x5149('0xa')][_0x5149('0x2b')](_0x1a86df)[_0x5149('0x18')]=!0x0);}),this['focusTracker']=new _0x54a10b(),this[_0x5149('0x2d')]['on'](_0x5149('0x1c'),(_0xb0a208,_0x1d348a,_0x5c78f4)=>{_0x5c78f4||(this[_0x5149('0x2')]=null);}),this['uiType']='',this[_0x5149('0x10')]=new Map(),this[_0x5149('0xa')]=new Map(),this[_0x5149('0x9')]=new Map(),this['_throttledOrderUpdate']=_0x1a082f(()=>{this[_0x5149('0x1d')](),this[_0x5149('0x1b')]();},0x190,{'leading':!0x1});}[_0x5149('0x14')](){window['addEventListener'](_0x5149('0x12'),this[_0x5149('0x25')]);}[_0x5149('0x19')](_0xed64be,_0x28825c){if(this[_0x5149('0x10')]['has'](_0xed64be))throw new _0x286f97(_0x5149('0x1e'));if('function'!=typeof _0x28825c[_0x5149('0xb')]||_0x5149('0x21')!=typeof _0x28825c[_0x5149('0x4')])throw new _0x286f97('annotations-register-invalid-interface');this[_0x5149('0x10')][_0x5149('0x30')](_0xed64be,_0x28825c);}['switchTo'](_0x49b1be){if(!this['_uis'][_0x5149('0x2a')](_0x49b1be))throw new _0x286f97('annotations-switchto-missing-ui',this);this['uiType']!==_0x49b1be&&(this[_0x5149('0x1f')]&&this['_uis'][_0x5149('0x2b')](this[_0x5149('0x1f')])['detach'](),this[_0x5149('0x1f')]=_0x49b1be,this[_0x5149('0x10')][_0x5149('0x2b')](this[_0x5149('0x1f')])[_0x5149('0xb')]());}['add'](_0x30b4e0,_0x310c8b){if(this[_0x5149('0xa')]['has'](_0x30b4e0))throw new _0x286f97(_0x5149('0xe'),this);const _0x93d6d2=new _0x462dc9(this[_0x5149('0xd')][_0x5149('0x27')],_0x30b4e0);_0x93d6d2[_0x5149('0x16')](),this[_0x5149('0x2d')][_0x5149('0x29')](_0x93d6d2[_0x5149('0x0')]),_0x93d6d2[_0x5149('0x2d')]['on']('change:isFocused',(_0x3311ff,_0x1f7c6f,_0x2e85b2)=>{_0x2e85b2&&(this[_0x5149('0x2')]=_0x30b4e0);}),this[_0x5149('0x9')][_0x5149('0x30')](_0x30b4e0,_0x310c8b),this['_updateAnnotationTargetRect'](_0x93d6d2);const _0x3f61c8=this[_0x5149('0x2e')](_0x93d6d2[_0x5149('0x1a')]);return this[_0x5149('0x11')][_0x5149('0x29')](_0x93d6d2,_0x3f61c8),this[_0x5149('0xa')][_0x5149('0x30')](_0x30b4e0,_0x93d6d2),_0x93d6d2;}[_0x5149('0x8')](_0x4cf673){if(!this[_0x5149('0xa')]['has'](_0x4cf673))return;const _0x1799e1=this[_0x5149('0xa')][_0x5149('0x2b')](_0x4cf673);this[_0x5149('0x2d')][_0x5149('0x8')](_0x1799e1[_0x5149('0x0')]),this[_0x5149('0x2')]===_0x4cf673&&(this[_0x5149('0x2')]=null),this[_0x5149('0x11')][_0x5149('0x8')](_0x1799e1),_0x1799e1['destroy'](),this[_0x5149('0x9')][_0x5149('0xc')](_0x4cf673),this[_0x5149('0xa')][_0x5149('0xc')](_0x4cf673);}[_0x5149('0x1')](_0x590a04){const _0x426990=this[_0x5149('0x9')][_0x5149('0x2b')](_0x590a04)||null;return _0x5149('0x21')==typeof _0x426990?_0x426990():_0x426990;}[_0x5149('0xf')](_0x3a0f3b){return this[_0x5149('0xa')][_0x5149('0x2b')](_0x3a0f3b);}[_0x5149('0x3')](){this['fire']('refresh'),this['_throttledOrderUpdate']();}[_0x5149('0x26')](){super[_0x5149('0x26')](),window['removeEventListener']('resize',this[_0x5149('0x25')]),this['_throttledOrderUpdate'][_0x5149('0x15')](),this[_0x5149('0x11')][_0x5149('0x22')](_0x2b6c2c=>_0x2b6c2c[_0x5149('0x26')]());}[_0x5149('0x1d')](){for(const _0x2562cc of this[_0x5149('0x11')])this[_0x5149('0x17')](_0x2562cc);}['_updateAnnotationTargetRect'](_0x416b8f){const _0x1a9538=this['getTarget'](_0x416b8f[_0x5149('0x23')]);if(null!==_0x1a9538){if(!(_0x1a9538 instanceof _0x3316df||_0x31097f(_0x1a9538)))throw new _0x286f97(_0x5149('0x20'));_0x416b8f[_0x5149('0x1a')]=new _0x3316df(_0x1a9538);}}[_0x5149('0x1b')](){const _0x418fa5=Array[_0x5149('0x24')](this[_0x5149('0x11')])[_0x5149('0x2f')]((_0x15b28d,_0x3e53da)=>k(_0x15b28d['targetRect'],_0x3e53da[_0x5149('0x1a')]));for(let _0x8c4c2a=_0x418fa5['length']-0x1;_0x8c4c2a>0x0;_0x8c4c2a--){const _0xddf336=_0x418fa5[_0x8c4c2a];_0x8c4c2a!==this[_0x5149('0x11')][_0x5149('0x13')](_0xddf336)&&(this[_0x5149('0x11')][_0x5149('0x8')](_0xddf336),this['items']['add'](_0xddf336,_0x8c4c2a));}}['_getOrderInContent'](_0x4c208e){let _0x18400f=0x0;for(const _0xa09a75 of this[_0x5149('0x11')]){const _0x21d9b8=this['getTarget'](_0xa09a75['customView']);if(_0x21d9b8){if(k(_0x4c208e,new _0x3316df(_0x21d9b8))<0x0)return _0x18400f;_0x18400f++;}}return Math[_0x5149('0x28')](0x0,_0x18400f);}}function k(_0x15ab1c,_0x209937){const _0x8dc2f3=_0x15ab1c['top']-_0x209937[_0x5149('0x7')];return 0x0==_0x8dc2f3?_0x15ab1c[_0x5149('0x5')]-_0x209937['left']:_0x8dc2f3;}